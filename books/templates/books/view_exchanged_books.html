{% extends "layout.html" %}
{% block body_class %}exchanged-books-page{% endblock %}

{% block content %}
<header class="login-header">
    <a href="{% url 'Home' %}" class="back-arrow">
        <span class="material-icons">arrow_back</span>
    </a>

    <div class="login-logo">
        <img src="/media/images/website_logo.png" alt="BookLoop">
    </div>
    <div class="header-actions">
        {% if user.is_authenticated %}
            <a href="{% url 'profile' %}" class="profile-icon">
                <span class="material-icons">account_circle</span>
            </a>

            <a href="{% url 'Logout' %}" class="btn login-btn">
                Logout
            </a>
        {% endif %}
    </div>
</header>

<div class="container my-3 mx-5">

<h3 class="mb-4">My Exchanged Books</h3>

{% for r in exchanges %}

<div class="exchange-card p-4 mb-3">

    <div class="d-flex justify-content-between align-items-start">
        <div>
            <div class="exchange-title">{{ r.book.title }}</div>

            <div class="exchange-meta mt-1">
                {% if user == r.requester %}
                    Exchanged with {{ r.owner.username }}
                {% else %}
                    Exchanged with {{ r.requester.username }}
                {% endif %}
            </div>
        </div>

        <span class="badge bg-success exchange-badge-sm">Completed</span>
    </div>

    <div class="exchange-divider"></div>

    <div class="exchange-contact">
        {% if user == r.requester %}
            Contact: {{ r.owner.email }} | {{ r.owner.profile.phone }}
        {% else %}
            Contact: {{ r.requester.email }} | {{ r.requester.profile.phone }}
        {% endif %}
    </div>

    <a href="{% url 'book_detail' r.book.slug %}"
       class="btn btn-outline-primary btn-sm mt-3">
        View Book
    </a>

</div>

{% empty %}
<p>No exchanged books yet.</p>

{% endfor %}
</div>

{% endblock %}
